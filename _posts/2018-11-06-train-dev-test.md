---
layout:     post
title:      机器学习基础之训练集、开发集和测试集
keywords:   博客
categories: [机器学习]
tags:	    [训练集, 开发集, 测试集]
---

在实践中，为了使神经网络高效工作，我们需要不断的调整超参数和准备数据。可以说深度学习是一个高度迭代的过程：把某个想法转换为代码，实验并得到结果，分析结果改进想法，获得一个越来越好的神经网络。在这个过程中，正确的划分训练集、开发集和测试集是非常重要的。

## 训练集/开发集/测试集的作用

通常，在训练有监督的机器学习模型的时候，会将数据划分为训练集、开发集和测试集。目的是为了能够选出效果最好，泛化能力最佳的模型。

训练集：用来拟合模型，通过设置分类器的参数，训练分类模型。

开发集：当通过训练集训练出多个模型后，为了能找出效果最佳的模型，使用各个模型对开发集数据进行预测，并记录模型准确率。选出效果最佳的模型对应的参数，即用来调整模型参数。寻找最优的超参数，需要开发集。

测试集：用来最终评估模型的性能和分类能力。当已经确定所有参数后，可以使用测试集进行模型预测并评估模型的性能。

## 训练集/开发集/测试集的分割法

在以前的机器学习中，通常的分割法是训练集和测试集分别占整体数据的70%和30%。如果设定了开发集(也称为交叉验证集)，那比例可能是60%/20%/20%。当样本数量是一万个样本及以下时，这个比例被广泛认为是最佳方法。

在大数据的时代，样本数量达到百万个甚至更多时，开发集和测试集在整体数据的比例就变小了，比如有100万个训练样本，那开发集和测试集只要1万个样本就足够了，比例就是98%/1%/1%。  

## 训练集/开发集/测试集的数据分布  

在实践中，训练集和测试集的数据分布往往是不匹配的。为了获取足够多的数据，训练集的数据可能是人工生成的图片，也可能是网上爬到的图片，测试集的数据则更符合实际的数据分布。

吴恩达建议的经验法则是，确保开发集和测试集中的数据分布相同。原因是我们用开发集对不同的模型进行评估，改善模型在开发集上的性能。如果开发集和测试集的数据分布相同就很方便了。即使没有测试集也是可以的，用训练集尝试不同模型结构，用开发集去评估它们，根据结果进一步迭代，由于模型拟合了开发集的数据，所以开发集不能给予无偏的估计。(测试集可以给模型无偏的估计)


