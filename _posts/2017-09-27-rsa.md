---
layout:     post
title:      RSA算法及应用
keywords:   博客
categories: [Python]
tags:	    [编程]
---

RSA算法是现今使用最广泛的公钥密码算法，也是第一个能同时用于加密和数字签名的算法。

## RSA算法


（以下内容摘自百度百科）  
RSA公钥加密算法是1977年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。1987年7月首次在美国公布，当时他们三人都在麻省理工学院工作实习。RSA就是他们三人姓氏开头字母拼在一起组成的。   

RSA算法基于一个十分简单的数论事实：将两个大质数相乘十分容易，但是想要对其乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。  

RSA算法是一种非对称密码算法，所谓非对称，就是指该算法需要一对密钥，使用其中一个加密，则需要用另一个才能解密。（加密和解密使用的是两个不同的密钥） 
>  非对称加密算法实现机密信息交换的基本过程是：甲方生成一对密钥并将其中的一把作为公用密钥向其它方公开；得到该公用密钥的乙方使用该密钥对机密信息进行加密后再发送给甲方；甲方再用自己保存的另一把专用密钥对加密后的信息进行解密。

* RSA的算法涉及三个参数，n、e1、e2。  

* 其中，n是两个大质数p、q的积，n的二进制表示时所占用的位数，就是所谓的密钥长度。  

* e1和e2是一对相关的值，e1可以任意取，但要求e1与(p-1) &times; (q-1)互质；再选择e2，要求(e2 &times; e1)mod((p-1) &times; (q-1))=1。  

* （n，e1),(n，e2)就是密钥对。其中(n，e1)为公钥，(n，e2)为私钥。

* RSA加解密的算法完全相同，设A为明文，B为密文，则：A=B^e2 mod n；B=A^e1 mod n；（公钥加密体制中，一般用公钥加密，私钥解密）e1和e2可以互换使用，即：
A=B^e1 mod n；B=A^e2 mod n。


## RSA算法的应用

* 加密：公钥加密，私钥解密
 > A给B发送数据之前，用B给的公钥对数据进行加密；B收到之后用他自己的私钥来解密。这样即使其他人获得了数据也无法解密。 
 
* 数字签名：私钥加密，公钥解密
 > 为了保证信息传输的完整性以及发送者的身份认证，A先生成自己的公钥，然后发布给其他人；在发布文件的时候，加上自己的签名(对某个内容X，比如原文的MD5，加密得到Y)；其他人收到文件后，会用A的公钥解密Y得到Z，如果X=Z，则说明该文件是A发布的。
 
## 实践
 
* 求n
 > p = 17  
 > q = 19  
 > n = p &times; q = 323  

* 求L
 > L是p-1和q-1的最小公倍数  
 > L ＝ lcm（p－1， q－1）＝ lcm(16，18） ＝ 144 

* 求e1
 > E必须满足两个条件：e1是一个比1大比L小的数，e1和L的最大公约数为1(互质)， 用gcd(X,Y)来表示X，Y的最大公约数即  
 > 1 < e1 < 144，gcd（e1，144） ＝ 1   
 > e1 = 5  

* 求e2
 > e1是由e2计算出来的。e1、e2和L之间必须满足以下关系：  
 > 1 < e2 < L，e1 &times; e2 mod L ＝ 1   
 > e2 = 29 满足上面两个条件  

* 加密
 > 准备的明文必须是小于n的数，因为加密或者解密都要mod n其结果必须小于n   
 > 假设明文 ＝ 123，则密文 = 123<sup>5</sup> mod 323 = 225

* 解密
 > 明文 = 225<sup>29</sup>  mod 323 = 123